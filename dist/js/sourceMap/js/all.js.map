{"version":3,"sources":["index.js","sample.js"],"names":["_sample","require","CLASENAME","Index","imageDom","_classCallCheck","this","src","setEvent","existFlag","imageObj","Image","fileSize","width","height","lastModifiedTime","getLastModified","Date","getTime","xmlRequestObj","XMLHttpRequest","open","send","onreadystatechange","readyState","getResponseHeader","Sample","console","log"],"mappings":"wUAAAA,QAAAC,QAAA,yOAEA,IAAMC,UAAY,kBACGC,iBACjB,SAAAA,EAAYC,GAAUC,gBAAAC,KAAAH,GAClBG,KAAKF,SAAWA,EAChBE,KAAKC,IAAMD,KAAKF,SAASG,IACzBD,KAAKE,mEAKLF,KAAKC,IAAM,yHASPA,GACJ,IAAIE,GAAY,EACZC,EAAW,IAAIC,MAOnB,OANAD,EAASH,IAAMA,GAGU,GAArBG,EAASE,UAAoC,GAAlBF,EAASG,OAAiC,GAAnBH,EAASI,UAC3DL,GAAY,GAETA,yCASIF,GAEX,IAAIQ,EAAmBT,KAAKU,gBAAgBT,GAG5C,GAAKQ,EAKL,OAD2B,IAAIE,KAAKF,GACRG,kDAShBX,GACZ,IACIY,EAAgB,IAAIC,eAGxBD,EAAcE,KAAK,OAAQd,GAAK,GAGhCY,EAAcG,OAGdH,EAAcI,mBAAqB,WAC/B,GAAiC,IAA7BJ,EAAcK,WAEd,OADmBL,EAAcM,kBAAkB,2CApE9CtB,6aCHAuB,4GAEbC,QAAQC,IAAI,kCAFCF","file":"../../all.js","sourcesContent":["import sample from './sample';\n\nconst CLASENAME = 'timestamp_image';\nexport default class Index {\n    constructor(imageDom) {\n        this.imageDom = imageDom;\n        this.src = this.imageDom.src;\n        this.setEvent();\n    }\n\n    setEvent() {\n        //this.src = this.assetTimestamp(this.src);\n        this.src = 'http://sp.black.local.qw.to//img/uplcmn/2018/0320/my_ex_20180323_top.jpg?1213214133241';\n    }\n\n    /**\n     * image file exist or not\n     *\n     * @param string src: source path of image file\n     * @return boolean returns false if image file not exist, otherwise return true\n     * */\n    isExist(src) {\n        let existFlag = false;\n        let imageObj = new Image();\n        imageObj.src = src;\n\n        // @TODO how to judge a image exist or not in server\n        if (imageObj.fileSize >= 0 || (imageObj.width >= 0 && imageObj.height >= 0)) {\n            existFlag = true;\n        }\n        return existFlag;\n    }\n\n    /**\n     * get timestamp of image based on the last modified of image file\n     *\n     * @param string source path of image file\n     * @return Date timestamp of image path\n     * */\n    assetTimestamp(src) {\n        // @TODO async await get the result\n        let lastModifiedTime = this.getLastModified(src);\n\n        // cannot get image information ,like in bad internet environment\n        if (!lastModifiedTime) {\n            return;\n        }\n\n        let lastModifiedTimeDate = new Date(lastModifiedTime);\n        return lastModifiedTimeDate.getTime();\n    }\n\n    /**\n     * get last modified time of image file\n     *\n     * @param string source path of image file\n     * @return string last modified time of image file if image is exist in server\n     * */\n    getLastModified(src) {\n        let lastModifiedTime = '';\n        let xmlRequestObj = new XMLHttpRequest();\n\n        // head method, async\n        xmlRequestObj.open('head', src, true);\n\n        // http request send\n        xmlRequestObj.send();\n\n        // if status change to 4 will get response\n        xmlRequestObj.onreadystatechange = () => {\n            if (xmlRequestObj.readyState === 4) {\n                lastModifiedTime = xmlRequestObj.getResponseHeader('Last-Modified');\n                return lastModifiedTime;\n            }\n        };\n    }\n}\n","export default class Sample {\n    print() {\n        console.log('hello');\n    }\n}\n"]}